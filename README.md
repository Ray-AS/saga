# Saga

## Overview

This project is a full-stack interactive story generator that allows players to progress through dynamic narratives by making meaningful choices. The game maintains persistent state, enabling stories to evolve coherently over time rather than resetting each session.

Players interact with characters, explore branching storylines, and experience consequences based on their prior decisions.

## Demo

![Loading story and making one choice in story](/frontend/public/assets/example.gif)
**Live Preview Coming Soon**

## Table of Contents

- [Overview](#overview)
- [Demo](#demo)
- [Table of Contents](#table-of-contents)
- [Features](#features)
- [Tech Stack](#tech-stack)
- [API](#api)
- [Data Models](#data-models)
- [Gameplay](#gameplay)
- [Future Updates](#future-updates)
  
## Features

- **Branching Story:** Player choices influence success, narrative direction, and available future actions
- **Persistent Game State:** Progress and decisions are saved across sessions
- **Context-Aware AI Storytelling:** AI maintains character state, narrative acts, and story progression across turns
- **Narrative Progression System:** Stories advance through structured acts with tracked progress and ending conditions
- **Multiple Playthrough Support:** Players can start new runs without losing access to previous ones
- **Structured Choice System:** Choices are validated and resolved server-side to ensure narrative consistency
- **Multiple Endings:** Playthroughs can lead to different conclusions depending on accumulated decisions

## Tech Stack

### Backend

- Python
- FastAPI
- SQLAlchemy ORM
- PostgreSQL
- Pytest
- Groq/OpenAI API

### Frontend

- TypeScript
- React
- Next.js (App Router)
- Tailwind CSS

## API

| METHOD | ENDPOINT            | DESCRIPTION                                |
|--------|---------------------|--------------------------------------------|
| POST   | `/game/start`       | Start a new playthrough                    |
| GET    | `/game`             | List all playthroughs                      |
| GET    | `/game/{id}`        | Get the current state of a playthrough     |
| POST   | `/game/{id}/choose` | Advance a playthrough by making a choice   |
| GET    | `/game/{id}/story`  | Get the full story so far of a playthrough |
| DELETE | `/game/{id}`        | Delete a playthrough                       |

## Data Models

Each of these SQLAlchemy models correspond to a table in the PostgreSQL database:

- **GameSession:** Top-level metadata for a playthrough
- **Character:** Player stats and progression
- **StoryEntry:** Full narrative text per turn with relative order
- **HistoryEntry:** Player/AI turn history with relative order
- **Choice:** Available actions for a turn

## Gameplay

1. **Start a new story**
    - Click "Start" to create a new character.
2. **Read the story**
    - The story is presented in paragraphs. Each turn includes the latest events generated by the AI based on your choices.
3. **Make choices**
    - For each turn, select from a list of available actions. Your choices have intent levels (Careful, Standard, Bold, Desperate) that influence the outcome.
4. **Watch the narrative evolve**
    - After each choice, the AI generates the next part of the story. Success or failure affects the story and future choices.
    - Success is calculated by:
        - Stats (Force, Guile, Influence, Insight)
        - Intent (Careful, Standard, Bold, Desperate) [**Current Implementation:** all choices default to "careful"]
        - Chance (Game engine rolls a D20)
        - Difficulty of Choice (Easy, Medium, Hard, Extreme)
    - Each choice will progress the narrative towards a resolution
        - SETUP -> ESCALATION -> RESOLUTION
        - Once story has progressed far enough in the "RESOLUTION" act, an "in endgame" flag will trigger which allows the LLM to end the story at an appropriate turn.
5. **Resume or delete playthroughs**
    - Click "Resume" in the load menu to return to an existing playthrough
    - Click "Delete" in the load menu to remove an existing playthrough from the database

## Future Updates

### Gameplay & Narrative

- Character creation
- Playthrough settings (e.g. difficulty, length, genre, tone)
- Intent-choosing functionality
- Creating/loading save points

### UI / UX

- Improve UI (e.g. component libraries, dark mode, polish layout)
- Ending-specific screen (e.g. summary, tone, character alignment)
- Progress/dashboard screen (i.e. give details of a playthrough, fun stats)
- Loading states/buffered story output
- Music/background corresponding to tone of story/scene
- Dynamically-generated character/setting art

### Multiplayer

- Multiplayer/shared narratives (Websockets)

### Platform & Infrastructure

- Deploy and/or modify for easy download-and-play local setup
- User accounts
- Improve testing suite for more coverage; integration/end-to-end tests

## License

MIT License - see the [LICENSE](LICENSE) file for details.
